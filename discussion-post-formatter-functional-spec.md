# Discussion Post Formatter - Functional Specification (SPEC.md)

## 1. Document Control
1.1 Version: 0.1  
1.2 Status: Draft  
1.3 Owner: (Your Name)  
1.4 Reviewers: Classmates (UoPeople CS 1102)  
1.5 License: MIT (suggested)  
1.6 Repository: `https://github.com/<your-user>/discussion_post_formatter`

## 2. Overview
2.1 Purpose: Generate a formatted HTML discussion post (assignment text, intro, highlighted source, compiler output, program output, discussion response, references).  
2.2 Scope: Local Java console tool reading configured file paths and producing a single HTML artifact per unit.  
2.3 Out of Scope: Web UI, database persistence, multi-language parsing.  
2.4 Stakeholders: Student author, peers reviewing code/output.  
2.5 References: Course unit instructions, Java SE docs.

## 3. Goals
3.1 Reduce manual formatting time.  
3.2 Provide consistent academic presentation.  
3.3 Enable peer review of code + output in one artifact.  

## 4. System Context
4.1 Inputs: `config.txt` + assignment/reference text files + `.java` source files.  
4.2 Output: HTML file specified by `output_file_address`.  
4.3 External Tools: `javac`, `java` (local JDK).  
4.4 Constraints: Windows paths; single unit at a time.  
4.5 Assumptions: JDK on PATH; UTF-8 text files.

## 5. Functional Requirements
FR-01 Load key/value pairs from `config.txt`.  
FR-02 Replace `{UNIT-NUMBER}` tokens in configured paths.  
FR-03 Read assignment, intro, discussion, references, and source code files.  
FR-04 Compile user code for the unit (wildcard pattern currently).  
FR-05 Execute target main class (future: specify in config).  
FR-06 Capture compiler diagnostics and runtime output.  
FR-07 Apply simple syntax highlighting (regex) using theme rules.  
FR-08 Assemble HTML sections in fixed order.  
FR-09 Write final HTML to configured output path.  
FR-10 Allow user to override assignment text via console prompt.  
FR-11 Log (stdout) which defaults were used.  
FR-12 Provide selectable themes (CSS rule key/value pairs).  

## 6. Improvement Backlog (Move to `WISHLIST.md` when large)
B1 Robust glob expansion instead of single path string.  
B2 Configurable main class (e.g. `main_class=cs_1102_base.Unit_0.Discussion_Assignment`).  
B3 Better error segmentation (separate compiler vs runtime).  
B4 HTML template theming (external template file).  
B5 Safer path resolution (avoid absolute drive locking).  
B6 Unit test suite (JUnit) for `Config`, `Utils.runAssignment`, `Highlighter`.  
B7 Replace regex highlighter with tokenization.  
B8 CLI flags override (`--unit`, `--theme`, `--out`).  
B9 Export markdown alongside HTML.  
B10 Add checksum / provenance footer (academic integrity note).

## 7. Data Model (Implicit)
- Config Fields: unit (int), theme (string), multiple file *addresses*, derived *contents*.  
- Derived HTML: Section blocks (assignment, intro, code, compiler, output, discussion, references).  
- Theme Rules: key → inline CSS fragment (e.g. `keyword=color:blue;`).

## 8. Interface (CLI)
Step 1: Program start: `java -p out -m discussion_post_formatter/formatter.DiscussionPostFormatter`  
Step 2: Prompts for assignment text (Enter to accept file).  
Step 3: Prints status + writes HTML.

## 9. File Conventions
- `config.txt`: Keys use snake\_case.  
- Paths may include `{UNIT-NUMBER}` token.  
- Source code path currently uses wildcard pattern (`*.java`) but passed literally to `javac` (needs expansion).  

## 10. Non-Functional Requirements
NFR-01 Execution Time: < 3s typical.  
NFR-02 Portability: Should run on any JDK 17+ (avoid Windows-only assumptions).  
NFR-03 Readability: Generated HTML must be human-readable and minimally styled inline.  
NFR-04 Academic Integrity: No auto-answer generation; only formatting.  
NFR-05 Reliability: Graceful messaging when files missing (no crash).

## 11. Error Handling
- Missing file → Insert placeholder text + flag default used.  
- Compilation failure → Show compiler messages section; still produce HTML.  
- Runtime failure → Append error text in Program Output block.  

## 12. Theming
- Theme file: `themes/<name>.css` lines in `token=css-rule;` format.  
- Fallback default rules applied if theme missing.  
- Exposed tokens: `keyword`, `string`, `comment`. (Extendable.)

## 13. Security / Academic Notes
- No network calls; file IO only.  
- Avoid embedding secrets in config paths.  
- Add footer: "Generated by Discussion Post Formatter – retain authorship."

## 14. Testing Strategy (Planned)
T1 Unit: Parse `config.txt` with missing keys.  
T2 Unit: Highlight sample code snippet.  
T3 Integration: Simulate compilation success and failure.  
T4 Integration: Verify HTML contains all major sections.  
T5 Regression: Theme fallback when file absent.  

## 15. Risks
R1 Hardcoded absolute Windows paths reduce portability. Mitigation: switch to relative `./data/unit_{UNIT-NUMBER}/...`.  
R2 Wildcard compilation may fail if shell expansion unsupported. Mitigation: programmatic file enumeration.  
R3 Incorrect class name for execution. Mitigation: add configurable `main_class`.  

## 16. Open Issues
OI-01 `InitializeVariables.java` contains invalid generic types (`Map<String, int>`).  
OI-02 Duplicate output file handling in `Config.load` (two keys: `output_file_address` vs `output_file`).  
OI-03 Missing getter name mismatch (`getassignmentFileAddress` called but method not defined).  
OI-04 Syntax highlighter may wrap comment delimiters inside spans redundantly.

## 17. Change Log (Excerpt)
0.1 Initial specification scaffold.

## 18. Appendix
A1 Sample `config.txt` (redacted for brevity).  
A2 Suggested relative layout:  

